diff -Nur shadow-4.0.3.orig/lib/getdef.c shadow-4.0.3/lib/getdef.c
--- shadow-4.0.3.orig/lib/getdef.c	2002-01-06 15:08:00.000000000 +0100
+++ shadow-4.0.3/lib/getdef.c	2003-06-20 19:34:37.000000000 +0200
@@ -113,6 +113,10 @@
 	{ "SYSLOG_SG_ENAB",		NULL },
 	{ "SYSLOG_SU_ENAB",		NULL },
 #endif
+	{ "SYS_GID_MAX",		NULL },
+	{ "SYS_GID_MIN",		NULL },
+	{ "SYS_UID_MAX",		NULL },
+	{ "SYS_UID_MIN",		NULL },
 	{ "TTYGROUP",			NULL },
 	{ "TTYPERM",			NULL },
 	{ "TTYTYPE_FILE",		NULL },
--- shadow-4.0.4.1/man/groupadd.8.orig	2004-01-05 02:08:23.000000000 +0100
+++ shadow-4.0.4.1/man/groupadd.8	2004-02-29 00:40:47.255149000 +0100
@@ -30,7 +30,7 @@
 groupadd \- Create a new group
 .SH SYNOPSIS
 .TP 6
-\fBgroupadd\fR [\fB-g\fI gid \fR[\fB-o\fR]] [\fB-f\fR] \fIgroup\fR
+\fBgroupadd\fR [\fB-g\fI gid \fR[\fB-o\fR]] [\fB-f\fR] [\fB-r\fR] \fIgroup\fR
 .SH DESCRIPTION
 The \fBgroupadd\fR command creates a new group account using the values
 specified on the command line and the default values from the system. The
@@ -45,6 +45,9 @@
 This option causes to just exit with success status if the specified
 group already exists. With \fB-g\fR, if specified gid already exists,
 other (unique) gid is chosen (i.e. \fB-g\fR is turned off).
+.IP "\fB-r\fR"
+This flag is used to create a system group, with gid lower than usual
+(chosen between SYS_GID_MIN and SYS_GID_MAX).
 .SH FILES
 \fI/etc/group\fR	\- group account information
 .br
diff -Nur shadow-4.0.3.orig/man/pl/groupadd.8 shadow-4.0.3/man/pl/groupadd.8
--- shadow-4.0.3.orig/man/pl/groupadd.8	2003-06-20 19:06:15.000000000 +0200
+++ shadow-4.0.3/man/pl/groupadd.8	2003-06-20 19:40:17.000000000 +0200
@@ -30,7 +30,7 @@
 .SH NAZWA
 groupadd - twÛrz now± grupÍ
 .SH SK£ADNIA
-\fBgroupadd\fR [\fB-g\fR \fIgid\fR [\fB-o\fR]] [\fB-f\fR] \fIgrupa\fR
+\fBgroupadd\fR [\fB-g\fR \fIgid\fR [\fB-o\fR]] [\fB-f\fR] [\fB-r\fR] \fIgrupa\fR
 .SH OPIS
 Polecenie \fBgroupadd\fR tworzy nowe konto grupy pos≥uguj±c siÍ
 warto∂ciami podanymi w wierszu poleceÒ i domy∂lnymi warto∂ciami z systemu.
@@ -48,6 +48,10 @@
 Ta opcja powoduje zakoÒczenie programu ze statusem oznaczaj±cym sukces je∂li
 podana groupa juø istnieje. Z opcj± \fB-g\fR, je∂li podany gid juø istnieje,
 wybierany jest inny (unikalny) gid (czyli \fB-g\fR jest wy≥±czane).
+.TP
+.BI -r
+Ta opcja s≥uøy do zak≥adania grup systemowych, z identyfikatorami niøszymi
+niø zwykle (wybieranymi z przedzia≥u od SYS_GID_MIN do SYS_GID_MAX).
 .SH PLIKI
 .IR /etc/group "   - informacja o kontach grup"
 .br
diff -Nur shadow-4.0.3.orig/man/pl/useradd.8 shadow-4.0.3/man/pl/useradd.8
--- shadow-4.0.3.orig/man/pl/useradd.8	2003-06-20 19:06:15.000000000 +0200
+++ shadow-4.0.3/man/pl/useradd.8	2003-06-20 19:41:22.000000000 +0200
@@ -106,12 +106,9 @@
 .IP "\fB-p \fIpasswd\fR"
 Zakodowane has≥o w postaci zwracanej przez \fBcrypt\fR(3).
 Domy∂lnym dzia≥aniem jest blokowanie konta.
-.\" .IP \fB-r\fR
-.\" Tworzenie konta systemowego. Ta opcja pozwala na utworzenie konta o UID
-.\" niøszym niø UID_MIN zdefiniowane w fI/etc/login.defs\fR. O ile nie poda siÍ
-.\" dodatkowo opcji \fB-m\fR nie jest tworzony katalog domowy dla tak tworzonego
-.\" uøytkownika niezaleønie od tego czy tworzenie katalogu jest ustawione czy
-.\" nie w \fI/etc/login.defs\fR.
+.IP \fB-r\fR
+Tworzenie konta systemowego, z identyfikatorem niøszym niø zwykle
+(wybieranym z przedzia≥u od SYS_UID_MIN do SYS_UID_MAX). 
 .IP "\fB-s \fIpow≥oka\fR"
 Nazwa pow≥oki (shell) uøytkownika. Ustawienie tego pola na puste
 powoduje, øe system wybierze domy∂ln± pow≥okÍ logowania.
--- shadow-4.0.4.1/man/useradd.8.orig	2003-05-07 16:04:53.000000000 +0200
+++ shadow-4.0.4.1/man/useradd.8	2004-02-29 00:41:58.145372048 +0100
@@ -38,7 +38,7 @@
 .br
 [[\fB-M\fR] \fB-m\fR [\fB-k\fR \fIskeleton_dir\fR]] [\fB-o\fR] [\fB-p\fR \fIpasswd\fR]
 .br
-[\fB-s\fR \fIshell\fR] [\fB-u\fR \fIuid\fR] \fIlogin\fR
+[\fB-r\fR] [\fB-s\fR \fIshell\fR] [\fB-u\fR \fIuid\fR] \fIlogin\fR
 .TP 8
 \fBuseradd\fR \fB-D\fR [\fB-g\fI default_group\fR] [\fB-b\fI default_home\fR]
 .br
@@ -96,6 +96,9 @@
 .IP "\fB-p \fIpasswd\fR"
 The encrypted password, as returned by \fBcrypt\fR(3). The default is to
 disable the account.
+.IP "\fB-r\fR"
+This flag is used to create a system account, with uid lower than
+usual (chosen between SYS_UID_MIN and SYS_UID_MAX).
 .IP "\fB-s\fR \fIshell\fR"
 The name of the user's login shell. The default is to leave this field
 blank, which causes the system to select the default login shell.
--- shadow-4.0.4.1/po/cs.po.orig	2004-02-29 01:08:36.961315080 +0100
+++ shadow-4.0.4.1/po/cs.po	2004-02-29 01:09:26.960714016 +0100
@@ -768,8 +768,8 @@
 msgstr "%s: nelze aktualizovat soubory s DBM datab√°zemi st√≠nov√Ωch hesel\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "Pou≈æit√≠: groupadd [-g gid [-o]] [-f] skupina\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "Pou≈æit√≠: groupadd [-g gid [-o]] [-f] [-r] skupina\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1769,8 +1769,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                 [-f vypnut√≠] [-e vypr≈°en√≠]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                 [-p heslo]  jm√©no\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                 [-p heslo] [-r]  jm√©no\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/de.po.orig	2004-02-29 01:08:36.966314320 +0100
+++ shadow-4.0.4.1/po/de.po	2004-02-29 01:10:04.905945464 +0100
@@ -769,8 +769,8 @@
 msgstr "%s: DBM-Shadow-Dateien k√∂nnen nicht aktualisiert werden\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "Syntax: groupadd [-g gid [-o]] [-f] Gruppe\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "Syntax: groupadd [-g gid [-o]] [-f] [-r] Gruppe\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1769,8 +1769,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                [-f inaktiv] [-e Ablauf]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                [-p Kennwort] Name\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                [-p Kennwort] [-r] Name\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/el.po.orig	2004-02-29 01:08:36.971313560 +0100
+++ shadow-4.0.4.1/po/el.po	2004-02-29 01:10:30.875997416 +0100
@@ -775,8 +775,8 @@
 msgstr "%s: Œ±Œ¥œÖŒΩŒ±ŒºŒØŒ± Œ±ŒΩŒ±ŒΩŒ≠œâœÉŒ∑œÇ œÑœâŒΩ DBM Œ±œÅœáŒµŒØœâŒΩ œÉŒ∫ŒπœâŒ¥œéŒΩ œÉœÖŒΩŒ∏Œ∑ŒºŒ±œÑŒπŒ∫œéŒΩ\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "œáœÅŒÆœÉŒ∑: groupadd [-g gid [-o]] [-f] ŒøŒºŒ¨Œ¥Œ±\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "œáœÅŒÆœÉŒ∑: groupadd [-g gid [-o]] [-f] [-r] ŒøŒºŒ¨Œ¥Œ±\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1798,8 +1798,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "               [-f Œ±ŒΩŒµŒΩŒµœÅŒ≥œå] [-e ŒªŒÆŒæŒ∑]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "               [-p œÉœÖŒΩŒ∏Œ∑ŒºŒ±œÑŒπŒ∫œå] œåŒΩŒøŒºŒ±\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "               [-p œÉœÖŒΩŒ∏Œ∑ŒºŒ±œÑŒπŒ∫œå] [-r] œåŒΩŒøŒºŒ±\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/fr.po.orig	2004-02-29 01:08:36.976312800 +0100
+++ shadow-4.0.4.1/po/fr.po	2004-02-29 01:10:54.569395472 +0100
@@ -772,8 +772,8 @@
 msgstr "%s: impossible de mettre √† jours les fichiers DBM shadow\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "Usage: groupadd [-g gid [-o]] [-f] groupe\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "Usage: groupadd [-g gid [-o]] [-f] [-r] groupe\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1771,8 +1771,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "               [-f inactif] [-e expire]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "               [-p mot-de-passe] nom\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "               [-p mot-de-passe] [-r] nom\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/ja.po.orig	2004-02-29 01:08:36.981312040 +0100
+++ shadow-4.0.4.1/po/ja.po	2004-02-29 01:12:06.636439616 +0100
@@ -773,8 +773,8 @@
 
 #: src/groupadd.c:102
 #, fuzzy
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "‰ΩøÁî®Ê≥ï: groupadd [-g „Ç∞„É´„Éº„ÉóID [-o]] „Ç∞„É´„Éº„Éó\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "‰ΩøÁî®Ê≥ï: groupadd [-g „Ç∞„É´„Éº„ÉóID [-o]] [-f] [-r] „Ç∞„É´„Éº„Éó\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1767,8 +1767,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                [-f ÁÑ°ÂäπÊó•Êï∞] [-e ÊúüÈôêÂàá„ÇåÊó•]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                [-p „Éë„Çπ„ÉØ„Éº„Éâ] „É¶„Éº„Ç∂Âêç\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                [-p „Éë„Çπ„ÉØ„Éº„Éâ] [-r] „É¶„Éº„Ç∂Âêç\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/ko.po.orig	2004-02-29 01:08:36.986311280 +0100
+++ shadow-4.0.4.1/po/ko.po	2004-02-29 01:12:19.165534904 +0100
@@ -767,8 +767,8 @@
 
 #: src/groupadd.c:102
 #, fuzzy
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "ÏÇ¨Ïö©Î≤ï: groupadd [-g gid(Í∑∏Î£π ÏïÑÏù¥Îîî) [-o]] Í∑∏Î£πÎ™Ö\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "ÏÇ¨Ïö©Î≤ï: groupadd [-g gid(Í∑∏Î£π ÏïÑÏù¥Îîî) [-o]] [-f] [-r] Í∑∏Î£πÎ™Ö\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1772,8 +1772,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                [-f ÎπÑÌôúÏÑ±Ìôî] [-e ÎßåÍ∏∞]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                [-p Ìå®Ïä§ÏõåÎìú] Ïù¥Î¶Ñ\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                [-p Ìå®Ïä§ÏõåÎìú] [-r] Ïù¥Î¶Ñ\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/pl.po.orig	2004-02-29 01:08:36.990310672 +0100
+++ shadow-4.0.4.1/po/pl.po	2004-02-29 01:12:55.314039496 +0100
@@ -770,8 +770,8 @@
 msgstr "%s: nie mo≈ºna zaktualizowaƒá pliku DBM z ukrytymi has≈Çami\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "U≈ºycie: groupadd [-g gid [-o]] [-f] grupa\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "U≈ºycie: groupadd [-g gid [-o]] [-f] [-r] grupa\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1770,8 +1770,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                [-f nieaktywne] [-e utrata_wa≈ºno≈õci]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                [-p has≥o] nazwa\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                [-p has≥o] [-r] nazwa\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/sv.po.orig	2004-02-29 01:08:36.994310064 +0100
+++ shadow-4.0.4.1/po/sv.po	2004-02-29 01:13:32.484388744 +0100
@@ -766,8 +766,8 @@
 msgstr "%s: kan inte uppdatera DBM-skuggfiler\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "Anv√§ndning: groupadd [-g gid [-o]] [-f] grupp\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "Anv√§ndning: groupadd [-g gid [-o]] [-f] [-r] grupp\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1761,8 +1761,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                    [-f inaktiv] [-e upph√∂r]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                    [-p passwd] namn\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                    [-p passwd] [-r] namn\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/uk.po.orig	2004-02-29 01:08:37.000309152 +0100
+++ shadow-4.0.4.1/po/uk.po	2004-02-29 01:13:52.693316520 +0100
@@ -771,8 +771,8 @@
 msgstr "%s: –Ω–µ –º–æ–∂—É –æ–Ω–æ–≤–∏—Ç–∏ DBM —Ñ–∞–π–ª –∑ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–º–∏ –ø–∞—Ä–æ–ª—è–º–∏\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ: groupadd [-g gid [-o]] [-f] –≥—Ä—É–ø–∞\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ: groupadd [-g gid [-o]] [-f] [-r] –≥—Ä—É–ø–∞\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1777,8 +1777,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                 [-f –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏–π] [-e –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–∏–π]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                 [-p –ø–∞—Ä–æ–ª—å] —ñ–º'—è\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                 [-p –ø–∞—Ä–æ–ª—å] [-r] —ñ–º'—è\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/po/ru.po.orig	2004-02-29 01:08:37.000000000 +0100
+++ shadow-4.0.4.1/po/ru.po	2004-02-29 01:13:16.948750520 +0100
@@ -764,8 +764,8 @@
 msgstr "%s: –Ω–µ –º–æ–≥—É –æ–±–Ω–æ–≤–∏—Ç—å shadow-—Ñ–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö\n"
 
 #: src/groupadd.c:102
-msgid "Usage: groupadd [-g gid [-o]] [-f] group\n"
-msgstr "–∑–∞–ø—É—Å–∫: groupadd [-g gid [-o]] [-f] –≥—Ä—É–ø–ø–∞\n"
+msgid "Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"
+msgstr "–∑–∞–ø—É—Å–∫: groupadd [-g gid [-o]] [-f] [-r] –≥—Ä—É–ø–ø–∞\n"
 
 #: src/groupadd.c:168 src/groupadd.c:193 src/groupmod.c:180 src/groupmod.c:229
 #: src/useradd.c:940 src/usermod.c:533 src/usermod.c:676
@@ -1770,8 +1770,8 @@
 msgid "               [-f inactive] [-e expire]\n"
 msgstr "                [-f –Ω–µ–∞–∫—Ç–∏–≤–Ω.] [-e –∏—Å—Ç–µ–∫–∞–µ—Ç]\n"
 
-msgid "               [-p passwd] name\n"
-msgstr "                [-p –ø–∞—Ä–æ–ª—å] –∏–º—è\n"
+msgid "               [-p passwd] [-r] name\n"
+msgstr "                [-p –ø–∞—Ä–æ–ª—å] [-r] –∏–º—è\n"
 
 #: src/useradd.c:733
 msgid "       useradd -D [-g group] [-b base] [-s shell]\n"
--- shadow-4.0.4.1/src/groupadd.c.orig	2004-01-05 02:08:56.000000000 +0100
+++ shadow-4.0.4.1/src/groupadd.c	2004-02-29 01:15:16.315604000 +0100
@@ -72,6 +72,7 @@
 static int oflg = 0;		/* permit non-unique group ID to be specified with -g */
 static int gflg = 0;		/* ID value for the new group */
 static int fflg = 0;		/* if group already exists, do nothing and exit(0) */
+static int rflg = 0;		/* add system group (with lower gid) */
 
 #ifdef	NDBM
 extern int gr_dbm_mode;
@@ -99,7 +100,7 @@
 
 static void usage (void)
 {
-	fprintf (stderr, _("Usage: groupadd [-g gid [-o]] [-f] group\n"));
+	fprintf (stderr, _("Usage: groupadd [-g gid [-o]] [-f] [-r] group\n"));
 	exit (E_USAGE);
 }
 
@@ -225,8 +226,13 @@
 	const struct group *grp;
 	gid_t gid_min, gid_max;
 
-	gid_min = getdef_unum ("GID_MIN", 100);
-	gid_max = getdef_unum ("GID_MAX", 60000);
+	if (!rflg) {
+		gid_min = getdef_unum ("GID_MIN", 500);
+		gid_max = getdef_unum ("GID_MAX", 60000);
+	} else {
+		gid_min = getdef_unum ("SYS_GID_MIN", 10);
+		gid_max = getdef_unum ("SYS_GID_MAX", 499);
+	}
 
 	/*
 	 * Start with some GID value if the user didn't provide us with
@@ -334,7 +340,7 @@
 	char *cp;
 	int arg;
 
-	while ((arg = getopt (argc, argv, "og:O:f")) != EOF) {
+	while ((arg = getopt (argc, argv, "og:O:fr")) != EOF) {
 		switch (arg) {
 		case 'g':
 			gflg++;
@@ -380,6 +386,12 @@
 			 */
 			fflg++;
 			break;
+		case 'r':
+			/*
+			 * create system group
+			 */
+			rflg++;
+			break;
 		default:
 			usage ();
 		}
--- shadow-4.0.4.1/src/useradd.c.orig	2004-02-29 01:14:44.212484416 +0100
+++ shadow-4.0.4.1/src/useradd.c	2004-02-29 01:15:56.318522632 +0100
@@ -72,10 +72,10 @@
 /*
  * These defaults are used if there is no defaults file.
  */
-static gid_t def_group = 100;
+static gid_t def_group = 1000;
 static const char *def_gname = "other";
-static const char *def_home = "/home";
-static const char *def_shell = "";
+static const char *def_home = "/home/users";
+static const char *def_shell = "/dev/null";
 static const char *def_template = SKEL_DIR;
 
 #ifdef SHADOWPWD
@@ -88,7 +88,7 @@
 #define	VALID(s)	(strcspn (s, ":\n") == strlen (s))
 
 static const char *user_name = "";
-static const char *user_pass = "!";
+static const char *user_pass = "!!";
 static uid_t user_id;
 static gid_t user_gid;
 static const char *user_comment = "";
@@ -121,6 +121,7 @@
  mflg = 0,			/* create user's home directory if it doesn't exist */
  nflg = 0,			/* create a group having the same name as the user */
  oflg = 0,			/* permit non-unique user ID to be specified with -u */
+ rflg = 0,			/* create system account (wuth lower uid) */
  sflg = 0,			/* shell program for new account */
  uflg = 0;			/* specify user ID for new account */
 
@@ -702,7 +703,7 @@
 #ifdef SHADOWPWD
 	fprintf (stderr, _("               [-f inactive] [-e expire]\n"));
 #endif
-	fprintf (stderr, _("               [-p passwd] name\n"));
+	fprintf (stderr, _("               [-p passwd] [-r] name\n"));
 	fprintf (stderr,
 		 _("       useradd -D [-g group] [-b base] [-s shell]\n"));
 #ifdef SHADOWPWD
@@ -950,8 +951,13 @@
 	const struct passwd *pwd;
 	uid_t uid_min, uid_max;
 
-	uid_min = getdef_unum ("UID_MIN", 100);
-	uid_max = getdef_unum ("UID_MAX", 60000);
+	if (!rflg) {
+		uid_min = getdef_unum ("UID_MIN", 500);
+		uid_max = getdef_unum ("UID_MAX", 60000);
+	} else {
+		uid_min = getdef_unum ("SYS_UID_MIN", 1);
+		uid_max = getdef_unum ("SYS_UID_MAX", 499);
+	}
 
 	/*
 	 * Start with some UID value if the user didn't provide us with
@@ -1033,9 +1039,9 @@
 	char *cp;
 
 #ifdef SHADOWPWD
-#define FLAGS "A:Du:og:G:d:s:c:mk:p:f:e:b:O:M"
+#define FLAGS "A:Du:og:G:d:s:c:mk:p:f:e:b:O:Mr"
 #else
-#define FLAGS "A:Du:og:G:d:s:c:mk:p:b:O:M"
+#define FLAGS "A:Du:og:G:d:s:c:mk:p:b:O:Mr"
 #endif
 	while ((arg = getopt (argc, argv, FLAGS)) != EOF) {
 #undef FLAGS
@@ -1189,6 +1195,9 @@
 			}
 			user_pass = optarg;
 			break;
+		case 'r':	/* create system account */
+			rflg++;
+			break;
 		case 's':
 			if (!VALID (optarg) || (optarg[0] &&
 						(optarg[0] != '/'
